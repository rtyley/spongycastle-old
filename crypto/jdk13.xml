<!DOCTYPE project [
 	<!ENTITY Common SYSTEM "common.xml">
	%Common;
]>

<!--
  Bouncy Castle Build Configuration (midp)

  This is the JDK 1.3 specific build file.  

  $RCSfile: jdk13.xml,v $
  $Author: bouncy $
  $Date: 2005-07-06 13:02:52 $
  $Revision: 1.1 $
-->
<project name="jdk13" default="init" basedir=".">

	<property environment="env" />
	<property file="${env.CRYPTO_PROP}" />

	<property name="junit.jar" value="${env.JUNIT_ROOT}/junit.jar" />
	<property name="activation.jar" value="${user.mailjars}/activation.jar" />
	<property name="mail.jar" value="${user.mailjars}/mail.jar" />
	<property name="mailapi.jar" value="${user.mailjars}/mailapi.jar" />

	<!-- Public callable targets -->
	<target name="clean" depends="common-clean" />
	<target name="test" depends="common-test" />
	<target name="dist" depends="common-dist" />
	<target name="package" depends="common-package" />
	<target name="compile" depends="local-compile" />
	<target name="jdoc" depends="common-jdoc" />

	<!-- include common targets, properties -->
	<property name="master.jdk" value="jdk13" />
	&Common;

	<!-- ** Private properties -->
	<path id="compile.cp">
		<pathelement location="${master.classes}" />
		<pathelement location="${junit.jar}" />
		<pathelement location="${activation.jar}" />
		<pathelement location="${mail.jar}" />
		<pathelement location="${mailapi.jar}" />
	</path>

	<!-- *** Private Targets *** -->
	<target name="local-compile" >
		<antcall target="jdk13compat-java" />
		<antcall target="part1-compile" />
		<antcall target="jdk13compat-bc" />
		<antcall target="part2-compile" />
		<antcall target="jdk13compat-test" />
	</target>

	<target name="jdk13compat-java" depends="init" >
		<javac srcdir="${master.home}/jdk1.3" 
			destdir="${master.classes}" 
			includes="java/**" >
			<classpath refid = "compile.cp" />
		</javac>
	</target>

	<target name="jdk13compat-bc" depends="init" >
		<javac srcdir="${master.home}/jdk1.3" 
			destdir="${master.classes}" 
			includes="org/**" 
			excludes="org/bouncycastle/jce/provider/test/**" >
			<classpath refid = "compile.cp" />
		</javac>
	</target>

	<target name="jdk13compat-test" depends="init" >
		<javac srcdir="${master.home}/jdk1.3" 
			destdir="${master.classes}" 
			includes="org/bouncycastle/jce/provider/test/**" >
			<classpath refid = "compile.cp" />
		</javac>
	</target>

	<target name="part1-compile" >
		<javac srcdir="${master.src}"
			destdir="${master.classes}">
			<classpath refid = "compile.cp" />
			<include name="org/bouncycastle/asn1/**" />
			<include name="org/bouncycastle/crypto/**" />
			<include name="org/bouncycastle/math/**" />
			<include name="org/bouncycastle/openssl/**" />
			<include name="org/bouncycastle/util/**" />
			<include name="org/bouncycastle/jce/interfaces" />
			<include name="org/bouncycastle/jce/netscape" />
			<include name="org/bouncycastle/jce/spec" />
			<include name="org/bouncycastle/jce/provider/JDKX509CertFactory.java" />
			<include name="org/bouncycastle/jce/provider/X509CRLObject.java" />
			<include name="org/bouncycastle/jce/provider/X509CertificateObject.java" />
		</javac>
	</target>

	<target name="part2-compile" >
		<javac srcdir="${master.src}"
			destdir="${master.classes}">
			<classpath refid = "compile.cp" />
			<include name="org/bouncycastle/jce/**" />
			<include name="org/bouncycastle/jce/cms/**" />
			<include name="org/bouncycastle/mail/**" />
			<exclude name="org/bouncycastle/jce/provider/test/**" />
		</javac>
	</target>


	<target name="cast" depends="compile" >
		<java classname="org.bouncycastle.crypto.test.CAST6Test"
			classpathref="compile.cp"
			fork="yes" />
	</target>

	<target name="profile" depends="compile" >
		<java classname="intuitive.audit.Audit"
			fork="yes" >
			<jvmarg line="-classic -Xrunoii" />
			<!-- <arg line="-offlineprofiling:initialDelay=5,delay=10,directory=f:/profiles,filename=rsa,appendTime=false,includeCPU=true -startCPUprofiler:type=sampler,displayPrecision=method,samplingPeriod=5 org.bouncycastle.crypto.test.RSATest" /> -->
			<arg line="-offlineprofiling:initialDelay=5,delay=10,directory=c:/usr/tmp/profiles,filename=rsa,appendTime=false,includeCPU=true -startCPUprofiler:type=instrumentation,precision=milli -filter:patternList=(java.lang.Object) org.bouncycastle.crypto.test.RSATest" />
			<classpath>
				<pathelement location="${master.classes}" />
				<pathelement location="c:/OptimizeItProfiler/OptimizeIt41/lib/optit.jar" />

			</classpath>
		</java>
	</target>

</project>
